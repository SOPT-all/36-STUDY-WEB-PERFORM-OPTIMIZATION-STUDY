# 성능 최적화는 왜 필요할까?

웹 성능을 위해 여러 시도 中 : Lighthouse나 AMP과 같은 기술 등장

> **구글 왈 : 성능이 저하되면 유저 다 떠나고 매출 감소한다.**

1초→ 3초 느려지면 유저 이탈률 32% 증가

1초 → 5초 느려지면 유저 이탈률 90% 증가

1초 → 10초 느려지면 유저 이탈률 123% 증가

ex) 핀터레스트는 로딩 시간 40% 줄이면서 검색 유입률이나 가입자수를 15% 늘림

### 웹 성능 요소

![image.png](attachment:5e9584e8-5df7-4e73-bab7-0e917a4aec09:image.png)

1. 로딩 성능

   웹 페이지에 필요한 기타 리소스 다운

   - 다운로드 해야할 리소스 수 줄이거나 크기 줄이기
   - 코드 분할해서 다운 or 리소스 우선순위

2. 렌더링 성능
   - js 코드를 얼마나 효율적으로 썼냐

# 분석 툴 소개

- 크롬 개발자 도구 : F12나 ctrl+shift+i
  - 요소 검사
  - 네트워크 패널 : 리소스 로드되는 타이밍에 그 크기나 시점 보여줌
  - performance 패널 : 웹 페이지 로드될 때, 실행되는 작업 보여줌,, 코드가 느린 지 등
  - lighthouse 패널 : 웹사이트 성능 점수 측정, 개선 가이드 줌, 어떤 부분 최적화할지
    - mode : navigation(초기 페이지 로딩 성능), timespan(사용자 정의 시간동안), snapshot(현재상태)
    - categories : performance(로딩과정), accessibility(사용자 접근성 문제), best practices(웹 개발의 최신 표준을 기준에 두고), SEO (검색엔진), Progressive webapp(오프라인, PWA관련)
- webpack-bundle-analyzer
  - 불필요한 코드가 뭔지, 어떤 번들 파일에서 비중을 차지하는 중, 어떤 라이브러리 등

# 이미지 사이즈 최적화

너무 큰 이미지 무분별하게 사용하면, 네트워크 트래픽 증가

### 실습 코드

- Article 컴포넌트 : 목록 페이지에서 블로그 글을 나열할 때 하나의 블로그 글을 렌더링

  - removeSpecialCharacter : 매개변수로 넘어온 문자열에서 일부 특수 문자를 제거
  - getParametersForUnsplash : 이미지 사이트에서 이미지를 가져오는 필요 옵션 설정

- ViewPage 컴포넌트 : 리액트마크다운 컴포넌트가 있음 (마크다운 포맷 문자열을 md스타일로 렌더링)

### 해당 사이트 lighthouse 검사 시

<aside>
💫

여섯가지 지표에 가중치 내서 performance 평균값 냄!

FCP : 렌더링하는데 걸리는 시간 지표 (첫 페이지 진입해서 콘텐츠 뜨기까지 1.4초) **10%가중치**

SI : 스피드 인덱스, 시각적으로 표시되는 속도. 좀 더 빨리 로드 **10%가중치**

LCP : 페이지가 로드될때 화면에 있는 가장 큰 이미지나 텍스트 렌더링 시간 **25%가중치**

TTI : 사용자가 페이지와 상호작용이 가능한 시점까지 걸리는 시간 **10%가중치**

TBT : 페이지가 클릭, 키보드 입력 등의 차단된 시간까지 총합한 지표 **30%가중치**

CLS : 페이지 로드 과정에서 발생하는 예기치 못한 레이아웃 이동 측정 지표 **15%가중치**

</aside>

![image.png](attachment:b0435e91-4157-4f31-a52d-0d5e6a2bff19:image.png)

# 이미지 사이즈 최적화

### 비효율적인 이미지 분석

이미지를 적절한 사이즈 200Kib로 줄이기 → 1.65초로 로드 시간 줄이기 가능

ex) 이미지 본체는 1200x1200인데 실제 그려지는 건 120x120임

요즘 사용되는 레티나 디스플레이는 같은 공간(픽셀)에 더 많은 픽셀 사용할 수 도 있기에 2배정도가 적당!

⇒ 240x240이 적당!

- 정적 이미지라면 그냥 편집해서 직접 조절
- CDN활용
  cdn 형식 : http://cdn.image.com?src=[img src]&width=240&height240
  이런 식임 → 링크 상 조절 가능
- **현재 실습 코드에선?**
  지금 현재 실습 코드에서는 props.image에 [https://images.unpsplash~](https://images.unpsplash~등으로) 등으로 되어 있는데
  getParametersForUnsplash 함수에서 반환하는 쿼리스트링을 붙이면 w와 h이 붙어서 CDN역할 느낌이 되게 해줌 ⇒ 해당 함수 내에서의 인자값을 변경해주면 됨!
  ![image.png](attachment:bdc8e8b7-7b0b-4244-9d10-3b3837345c77:image.png)
